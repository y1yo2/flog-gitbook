---
description: 2021/03/17
---

# 虚拟机、容器、云原生-1

云原生是什么？必须先了解虚拟机、容器的概念，什么是虚拟机、容器，之间的区别，和云原生的关系。

## 虚拟机是什么？

虚拟机VM（Virtual Machine）是基于物理机，通过**虚拟化技术**，模拟出独立的硬件环境（CPU、内存、网络接口和存储器）的机器。

## 虚拟化是什么？

虚拟化是一种技术。通过对多台主机进行**资源池化管理**，分配形成客户机的技术；

> 主机：运行 虚拟机监控程序 的物理机
>
> 客户机：使用主机资源的虚拟机
>
> 资源池：所有主机的资源（CPU、内存、存储器）

### 虚拟化工作原理

* 通过Hypervisor（虚拟机监控程序），对物理资源分区分配（隔离）；
* 用户在虚拟环境中能够与计算任务交互，并运行计算；
* 虚拟机作为单个数据文件运行。打开和工作的方式一致，可在任意计算机上打开并运行（可迁移）；

（虚拟化结构图）

* 解决了基于硬件资源创建服务的局限；
  * 在不同硬件设备中，操作系统、应用程序可运行的类型和版本不同；
  * 多个服务器相互隔离，无法分区分配，共享资源；

（虚拟化解决的问题）

### 虚拟化的类型

* 桌面虚拟化
  * 自动化管理工具，一次向数百台物理机部署模拟桌面环境。在所有虚拟桌面上执行大规模的配置、更新和安全检查。
  * 桌面虚拟化，提供了一种便捷管理大规模虚拟机的实现方式。
* 操作系统虚拟化
  * 一台计算机可以运行多个操作系统。
* 服务器虚拟化
  * 单台服务器可以充当几台甚至几百台服务器的角色。
* 数据虚拟化
  * 分散在各处的数据可以整合为单个来源。
  * 化零为整，作为统一的数据源，以符合业务需求的形式、在正确的时间，向任意应用或用户提供所需数据。
* 网络功能虚拟化
  * 可从一个原始网络创建多个虚拟网络。
  * 网络功能虚拟化（NFV）是隔离网络的关键功能（例如目录服务、文件共享和 IP 配置）的架构；
    * **虚拟网络功能（VNF）**是提供网络功能（例如文件共享、目录服务和 IP 配置）的软件应用。
    * **网络功能虚拟化基础架构（NFVi）**包含了平台上的[基础架构组件](https://www.redhat.com/zh/topics/cloud-computing/what-is-it-infrastructure)（计算、存储、联网），从而支持运行网络应用所需的软件（例如像 [KVM](https://www.redhat.com/zh/topics/virtualization/what-is-KVM) 这样的[虚拟机监控程序](https://www.redhat.com/zh/topics/virtualization/what-is-a-hypervisor)）或容器管理平台。
    * **管理、自动化和网络编排（MANO）**提供了用于管理 NFV 基础架构和置备新 VNF 的框架

## 虚拟机监控程序

* 通过**分隔物理资源**并分配给不同虚拟环境使用，从而创建、运行、管理VM（虚拟机）的**程序**；
* Hypervisor是虚拟化的实现技术；

### 实现方式

虚拟机监控程序实现虚拟化的两种方式：

类型1：

* （本机或裸机）作为操作系统的一部分，运行在主机硬件上，直接调度硬件作为VM资源；
  * 例如 KVM\(Kernel-based Virtual Machine，Linux内核一部分\)
  * Microsoft Hyper-V；
* 业务场景：企业数据中心或其他基于服务器的环境；实现**主机资源池化**和分配，**客户机管理**；

（Hypervisor类型1结构图）

类型2：

* （托管）基于操作系统的一个应用程序，通过主机的操作系统调度硬件；
  * 例如 VMware Workstation 和 
  * Oracle VirtualBox；
* 业务场景：满足在个人主机运行多套操作系统的需求；

（Hypervisor类型2结构图）

两种类型的虚拟机监控程序，都必定包含资源管理的组件，如内存管理器、进程调度程序、I/O（输入输出）堆栈、设备驱动程序、安全管理器、网络堆栈等。

## 虚拟机

### 总结，虚拟机究竟是什么？

* 通过虚拟化技术，模拟出独立、隔离的硬件环境的机器；

### 为什么要用虚拟机/虚拟化技术？

* 资源池化，分区分配管理；
  * 更高效利用服务器，降低了采购、设置、散热和维护等成本；
* 通过VMM调度硬件，减少对机器型号的依赖；（VM manager） 
  * x86，32位，性能；
  * arm，64位，功耗；
* 环境隔离；
  * 适合不同环境的部署和应用测试等应用场景



> 参考资料：[虚拟机 Virtual Machine 是什么？](https://www.redhat.com/zh/topics/virtualization/what-is-a-virtual-machine)
>
> [虚拟化-何为虚拟化？](https://www.redhat.com/zh/topics/virtualization/what-is-virtualization)

> [虚拟化-什么是虚拟机监控程序？](https://www.redhat.com/zh/topics/virtualization/what-is-a-hypervisor)



