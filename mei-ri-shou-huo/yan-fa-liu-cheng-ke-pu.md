---
description: 2021/01/27
---

# 研发流程科普

## 工程管理的四个模型

瀑布模型、迭代模型、增量模型、原型模型

### 瀑布模型

瀑布模型又叫线性模型，

* 工程启动前，必须有完整的设计图。启动后，必须按照计划进行，不能改动。
* 每个阶段的输出，都是下个阶段的输入；所以每个阶段开始前，上个阶段的输出必须通过检查。（通过检查工作，保证输入质量）
* 每个阶段的必须产出文档，其次才是以文档为基础的产品。

总结：瀑布模型-**文档驱动**

#### 三个特点：

1. 按计划进行，不能改动；
2. 上阶段输出，是下阶段输入，检查保证质量；
3. 输出必须有文档，其次才是文档对应的产品；

#### 优点：

1. 每个阶段的质量保证，减少过程出错导致的返工；
2. 文档完备，方便沟通和复查，能及时发现风险；

#### 缺点：

1. 一次完整周期非常长；
2. 过程中无法改动；

所以只适合，需求非常明确，且基本不会更改，排期非常充足的项目，例如某些toB的本地部署项目；

我的理解：

瀑布模型用时间和灵活性，换取高质量和低风险；工作时只需看着目标认真工作即可；

### 迭代模型

迭代模型 = 多个小的瀑布模型；

* 每一次迭代，都会完整地执行所有工作流程：需求、分析设计、开发测试、交付；
* 每一次迭代，都会产出一个可发布的产品，该产品是最终产品的子集；

迭代类型：（迭代中的主要工作量）

* **初始阶段**，系统建立商业案例并确定项目的边界。（制定计划）
* **细化阶段**，目标是分析问题领域，建立健全的体系结构基础，编制项目计划，淘汰项目中最高风险的元素。（风险分析）
* **构造阶段**，所有剩余的构件和应用程序功能被开发并集成为产品，所有的功能被详细测试。（实施工程）
* **交付阶段**，重点是确保软件对最终用户是可用的。交付阶段可以跨越几次迭代，包括为发布做准备的产品测试，基于用户反馈的少量的调整。（客户评估）

我的理解：

迭代模型，将目标划分为多个可实现的小目标，每次只实现小目标，组成最终结果后交付。

优点是，在整个过程中，每次迭代开始前都是调整的机会，灵活；

缺点是，划分目标、调整迭代计划、每次迭代都要进行风险分析和管理；

所以迭代模型适合，需求不确定的高风险项目。

因为目标是每次迭代的风险管理和交付产品能够重用，整体质量只能通过可选方案的选择和约束条件保证。

迭代模型-**风险驱动**

### 增量模型

增量模型，本质上是迭代模型。

主要区别是：

* 只要确定部分需求，就能进行开发。
* 每一次发布一个可操作产品。（增量）

什么是增量模型？确定用户需求后，进行总体构架设计，采用序列化地开发产品的方法。

#### 优点：

1. 快速产出可操作的产品；
2. 因为开发的需求确定，所以管理风险更有计划；
3. 降低完成初始需求的成本；（每次迭代的需求确定）

#### 缺点：

容易变为边做边改，对整体的计划和过程控制不足。

所以增量模型适合，用户核心需求非常清楚；产品可以分割成多个可操作产品发布；项目人员/资源不足（每次只做一部分）；

增量模型-**任务（确定的需求产生的任务）驱动**

### 原型模型

通过快速开发原型，再逐步修改的方式完善产品。

根据原型的保留情况，分为**非抛弃型**和**抛弃型**两种：

**非抛弃型**：根据用户的基本需求，开发一个只实现基本功能的原型。根据用户的后续评价（需求），不断修改完善，最终得出满意的产品；

**抛弃型**：原型只用于描述或验证用户的需求，方便与客户沟通；需求确定后，原型就失去价值了。

我的理解：

原型模型只是帮助我们确定用户需求的一种方式，与其他过程管理的模型协同使用。

当整体需求简单，或者用户需求无法确定时，可通过原型模型加快、加深与用户的沟通。

原型模型-**用户需求驱动**

## 蓝绿部署

Blue Green Deployments

蓝绿部署，两套独立的，可运行的系统，通过路由进行切换。

具体场景是：使用新版本系统，替换线上的老版本，此时会运行两套系统（两倍的机器，独立不耦合）；

上线前对外提供服务的老系统是绿色系统，新部署的系统是蓝色系统。

* 蓝色系统在发布前，可以进行测试和修改，不影响绿色系统；
* 蓝色系统在发布后，绿色系统用于随时回滚，防止蓝色系统发生意外；

总结：

蓝色部署，是一种发布策略，适用于资源充足，系统无耦合不干扰的情况。

目的是尽量减少发布的停机时间，并能快速回滚。

（补充图片）

## 灰度发布

Canary releases（金丝雀发布）,其实是另一种发布策略。

灰度发布，一套系统，下面有多个服务器，每次只更新一小部分服务器观察；

具体场景是：要更新一个无状态的服务，线上有一万个该服务的实例；

一开始只将10个旧的实例换成新的实例，验证后在进行全量替换。

其中重要的操作是【流量控制】：

* 例如通过网关的负载均衡，设置权重、请求数；
* 灰度发布和 A/B测试，都会进行【流量控制】这个操作；

（补充图片）

蓝绿与灰度：

* 资源能否支持蓝色（2倍资源）；
* 服务是否独立，保证新老版本的服务互相不干扰；
* 能否做到流量控制；

## A/B 测试

A/B测试是一种线上测试；蓝绿、灰度是发布策略；

蓝绿、灰度的目标是，保证线上提供给用户的服务稳定，关注新系统上线后的BUG；

A/B测试的目标是，同时对外提供多个版本的服务（已经过线上验证），关注不同版本的服务的线上效果/数据；

具体场景：三台服务器运行着三个版本的系统，网关进行【流量控制】，分别给三个系统分配流量；

最终根据收集的数据，决定使用哪个版本。

（补充图片）

## 验收测试、回归测试、集成测试

**验收测试**，或者SVT，Beta测试，业界并没有强制的统一说法；

上线到生产环境之后，对本次发布的功能验证一遍。

方式：

* 两套环境来回切作为生产和准生产（灰度）；
* 以测试环境为主，生产环境升级后做验收和拨测，新功能通过开关控制上线；
* 准生产就是镜像环境，要求和生产环境一样的架构、网络、配置；

**回归测试**，就是提bug后，开发改好bug，下个测试周期对bug进行回归测试；

无论是迭代还是全量测试期间，都肯定会有回归测试这个动作，而且是在发布（上生产环境）之前；

**集成测试**，就是所有需求和bug都测试通过后，在上生产环境之前，跑所有/部分测试用例；

大项目基本会进行，SIT集成测试（在保证系统的单元测试和功能测试已经通过后）；

小项目根据模块风险程度，制定集成测试策略（是否做，做哪部分）；

当然，进行集成测试最能保证质量；

集成测试通常还能发现问题（总体的20%左右），主要是系统性的问题，比如性能、可靠性、安全、安装、升级、兼容性等等；

> 参考资料
>
> * [项目管理的四大模型，PM必须懂！](https://zhuanlan.zhihu.com/p/116754890)
> * [蓝绿部署、金丝雀发布（灰度发布）、A/B测试的准确定义](https://www.lijiaocn.com/%E6%96%B9%E6%B3%95/2018/10/23/devops-blue-green-deployment-ab-test-canary.html)
> * [Blue-green Deployments, A/B Testing, and Canary Releases](https://blog.christianposta.com/deploy/blue-green-deployments-a-b-testing-and-canary-releases/)
> * [BlueGreenDeployment](https://martinfowler.com/bliki/BlueGreenDeployment.html)

